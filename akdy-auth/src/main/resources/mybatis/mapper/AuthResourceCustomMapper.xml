<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.still.aikandy.auth.dao.AuthResourceCustomMapper">
  <sql id="Base_Column_List">
      <!--
        WARNING - @mbggenerated
        This element is automatically generated by MyBatis Generator, do not modify.
      -->
      id, category_id, create_time, `name`, url, description
  </sql>
  <sql id="Where">
      <where>
          <if test="id != null">
              AND id = #{id,jdbcType=INTEGER}
          </if>
          <if test="categoryId != null">
              AND category_id = #{categoryId,jdbcType=INTEGER}
          </if>
          <if test="name != null">
              AND `name` = #{name,jdbcType=VARCHAR}
          </if>
          <if test="description != null">
              AND `description` = #{description,jdbcType=VARCHAR}
          </if>
          <if test="nameKeyword != null">
              AND `name` like CONCAT('%',#{nameKeyword,jdbcType=VARCHAR},'%')
          </if>
          <if test="urlKeyword != null">
              AND url like CONCAT('%',#{urlKeyword,jdbcType=VARCHAR},'%')
          </if>
      </where>
    </sql>

  <select id="getAuthResourcesByCondition" resultType="com.still.aikandy.common.dto.AuthResourceDto">
      select
      <include refid="Base_Column_List"></include>
      from auth_resource
      <include refid="Where"></include>
  </select>
    <select id="getAuthResourceaByRoleId" resultType="com.still.aikandy.common.dto.AuthResourceDto">
        SELECT
            r.id id,
            r.category_id categoryId,
            r.`name` `name`,
            r.description description,
            r.url url,
            r.create_time createTime
        FROM
            auth_role_resource arr
                LEFT JOIN auth_resource r ON arr.resource_id = r.id
        WHERE
            arr.role_id = #{roleId}
        AND r.id IS NOT NULL
    </select>

    <delete id="deleteByCategoryId" parameterType="java.lang.Long">
        delete from auth_resource
        where category_id = #{categoryId,jdbcType=BIGINT}
    </delete>
</mapper>